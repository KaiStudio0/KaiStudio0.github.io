<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kai Rng Game</title>
  <style>
    /* Fuentes, reset global y estilos b√°sicos */
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Orbitron', monospace;
      background: linear-gradient(135deg, #0f0f23, #1a1a3a, #2d1b69);
      color: #fff;
      overflow-x: hidden;
      min-height: 100vh;
      position: relative;
    }
    .background-animation {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
      background: radial-gradient(circle at 20% 50%, rgba(120,119,198,0.3), transparent 50%),
                  radial-gradient(circle at 80% 20%, rgba(255,119,198,0.3), transparent 50%),
                  radial-gradient(circle at 40% 80%, rgba(119,198,255,0.3), transparent 50%);
      animation: backgroundPulse 4s ease-in-out infinite alternate;
    }
    @keyframes backgroundPulse { 0% { opacity: 0.5; } 100% { opacity: 0.8; } }
    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }

    /* Cabecera y estilo del t√≠tulo */
    .header {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
      position: relative;
    }
    .header h1 {
      font-size: 3rem;
      font-weight: 900;
      background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #ffeaa7);
      background-size: 300% 300%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: gradientShift 3s ease infinite;
      text-shadow: 0 0 30px rgba(255,255,255,0.5);
    }
    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    /* Datos del usuario e inputs unificados */
    .user-info {
      position: absolute; top: 10px; right: 20px; text-align: right;
    }
    .user-info img {
      width: 50px; height: 50px; border-radius: 50%; object-fit: cover;
    }
    /* Modal de Login */
    .modal {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.8);
      display: flex; justify-content: center; align-items: center;
      z-index: 2000;
    }
    .modal-content {
      background: #1a1a3a;
      padding: 30px;
      border-radius: 10px;
      width: 90%;
      max-width: 400px;
      text-align: center;
    }
    input[type="text"], input[type="file"] {
      padding: 12px;
      margin: 10px 0;
      border-radius: 8px;
      border: 2px solid #4ecdc4;
      background: #2d1b69;
      color: #fff;
      width: 90%;
      outline: none;
      transition: border 0.3s;
    }
    input[type="text"]:focus, input[type="file"]:focus { border-color: #ff6b6b; }
    .modal button {
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      background: #4ecdc4;
      color: #fff;
      cursor: pointer;
      font-weight: bold;
    }
    /* Error en el login: */
    #loginError { color: #ff6b6b; margin-bottom: 10px; }

    /* Tabs y sub-tabs */
    .tabs {
      display: flex; justify-content: center; margin-bottom: 30px; gap: 10px; flex-wrap: wrap;
    }
    .tab {
      background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,255,255,0.2);
      color: #fff;
      padding: 15px 30px;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 700;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }
    .tab:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(255,255,255,0.2); }
    .tab.active { background: linear-gradient(45deg, #ff6b6b, #4ecdc4); border-color: #fff; box-shadow: 0 0 30px rgba(255,255,255,0.3); }
    .tab-content { display: none; }
    .tab-content.active { display: block; text-align: center; }
    .leaderboard-tabs {
      display: flex; justify-content: center; gap: 20px; margin-bottom: 20px;
    }
    .lboard-tab {
      background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,255,255,0.2);
      color: #fff;
      padding: 10px 20px;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 700;
      transition: all 0.3s ease;
    }
    .lboard-tab.active { background: linear-gradient(45deg, #ff6b6b, #4ecdc4); border-color: #fff; }
    
    /* Estad√≠sticas superiores */
    .stats-bar {
      display: flex; justify-content: center; gap: 30px; margin: 20px 0; flex-wrap: wrap;
    }
    .stat {
      background: rgba(255,255,255,0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 15px;
      padding: 15px 25px;
      text-align: center;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }
    .stat-value { font-size: 1.5rem; font-weight: 700; color: #ffd700; }
    .stat-label { font-size: 0.9rem; opacity: 0.8; }
    
    /* Secci√≥n Main: Roll, animaci√≥n y botones (nota: el roll es gratis) */
    .roll-section {
      background: rgba(255,255,255,0.05);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 25px;
      padding: 40px;
      margin-bottom: 30px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.2);
    }
    .roll-animation {
      width: 300px;
      height: 200px;
      margin: 30px auto;
      background: rgba(0,0,0,0.3);
      border-radius: 20px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      border: 2px solid rgba(255,255,255,0.2);
      position: relative;
      overflow: hidden;
    }
    .aura-name {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 10px;
      text-shadow: 0 0 20px currentColor;
    }
    .aura-rarity {
      font-size: 1rem;
      opacity: 0.9;
      padding: 5px 15px;
      border-radius: 15px;
      background: rgba(255,255,255,0.1);
    }
    .roll-buttons {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 30px 0;
      flex-wrap: wrap;
    }
    .btn {
      background: linear-gradient(45deg, #667eea, #764ba2);
      border: none;
      color: white;
      padding: 15px 30px;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 700;
      font-size: 1rem;
      transition: all 0.3s ease;
      box-shadow: 0 8px 25px rgba(102,126,234,0.3);
      position: relative;
      overflow: hidden;
    }
    .btn:hover { transform: translateY(-3px); box-shadow: 0 15px 35px rgba(102,126,234,0.5); }
    .btn:active { transform: translateY(0); }
    .btn-roll { background: linear-gradient(45deg, #ff6b6b, #ee5a24); box-shadow: 0 8px 25px rgba(255,107,107,0.3); }
    .btn-auto { background: linear-gradient(45deg, #4ecdc4, #44a08d); box-shadow: 0 8px 25px rgba(78,205,196,0.3); }
    .btn-quick { background: linear-gradient(45deg, #45b7d1, #2980b9); box-shadow: 0 8px 25px rgba(69,183,209,0.3); }
    
    /* Secciones de Shop y Inventario */
    .shop-content, .inventory-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 30px;
    }
    .shop-section, .inventory-item {
      background: rgba(255,255,255,0.05);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 25px;
      padding: 30px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.2);
      text-align: center;
    }
    .shop-title { font-size: 1.5rem; font-weight: 700; margin-bottom: 20px; color: #ffd700; }
    .item-price { color: #ffd700; font-weight: 700; }
    
    /* Clases de rareza y nuevas raridades (‚ÄúQuantum‚Äù es la m√°s exclusiva) */
    .rarity-common { border-color: #95a5a6; color: #95a5a6; }
    .rarity-rare { border-color: #3498db; color: #3498db; }
    .rarity-epic { border-color: #9b59b6; color: #9b59b6; }
    .rarity-legendary { border-color: #f39c12; color: #f39c12; }
    .rarity-mythic { border-color: #e74c3c; color: #e74c3c; }
    .rarity-divine { border-color: #fd79a8; color: #fd79a8; }
    .rarity-celestial { border-color: #00cec9; color: #00cec9; }
    .rarity-transcendent { border-color: #6c5ce7; color: #6c5ce7; }
    .rarity-omnipotent { border-color: #ffd700; color: #ffd700; }
    .rarity-ethereal { border-color: #a29bfe; color: #a29bfe; }
    .rarity-fabled { border-color: #fd79a8; color: #fd79a8; }
    .rarity-ascended { border-color: #55efc4; color: #55efc4; }
    .rarity-infinite { border-color: #ffeaa7; color: #ffeaa7; }
    .rarity-quantum { border-color: #ff9ff3; color: #ff9ff3; }
    
    /* Animaciones: part√≠culas y shake */
    .particles {
      position: absolute; width: 100%; height: 100%; overflow: hidden;
    }
    .particle {
      position: absolute;
      width: 4px;
      height: 4px;
      background: #ffd700;
      border-radius: 50%;
      animation: particleFall 2s linear forwards;
    }
    @keyframes particleFall { to { transform: translateY(100vh); opacity: 0; } }
    .rolling { animation: rollSpin 1s linear infinite; }
    @keyframes rollSpin { from { transform: rotateY(0deg); } to { transform: rotateY(360deg); } }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      10%,30%,50%,70%,90% { transform: translateX(-5px); }
      20%,40%,60%,80% { transform: translateX(5px); }
    }
    
    @media (max-width: 768px) {
      .header h1 { font-size: 2rem; }
      .stats-bar { flex-direction: column; align-items: center; }
      .roll-buttons { flex-direction: column; align-items: center; }
      .shop-content { grid-template-columns: 1fr; }
    }
    
    /* Estilos para el Admin Panel (solo visible para ‚ÄúKai (owner)‚Äù) */
    #adminPanel {
      background: rgba(0,0,0,0.7);
      padding: 20px;
      border-radius: 10px;
      margin: 20px auto;
      max-width: 800px;
      text-align: center;
    }
    #adminPanel h2 { margin-bottom: 10px; }
    #adminPanel input[type="text"], #adminPanel input[type="number"] {
      padding: 8px;
      margin: 5px;
      border-radius: 5px;
      border: 2px solid #4ecdc4;
      background: #2d1b69;
      color: #fff;
      outline: none;
      transition: border 0.3s;
    }
    #adminPanel input[type="text"]:focus, #adminPanel input[type="number"]:focus {
      border-color: #ff6b6b;
    }
    #adminPanel button {
      padding: 8px 15px;
      border: none;
      border-radius: 5px;
      background: #4ecdc4;
      color: #fff;
      margin: 5px;
      cursor: pointer;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="background-animation"></div>
  
  <!-- Modal de Login -->
  <div class="modal" id="loginModal">
    <div class="modal-content">
      <h2>¬°Bienvenido a Kai Rng Game!</h2>
      <p>Ingresa tu nombre de usuario y selecciona un avatar para comenzar.</p>
      <input type="text" id="usernameInput" placeholder="Tu nombre" />
      <input type="file" id="avatarInput" accept="image/*" />
      <div id="loginError"></div>
      <button onclick="loginUser()">Entrar</button>
    </div>
  </div>
  
  <div class="container">
    <div class="header">
      <h1 class="title">‚ú® Kai Rng Game ‚ú®</h1>
      <div class="stats-bar">
        <div class="stat">
          <div class="stat-value" id="coins">1000</div>
          <div class="stat-label">üí∞ Monedas</div>
        </div>
        <div class="stat">
          <div class="stat-value" id="luck">1.0x</div>
          <div class="stat-label">üçÄ Suerte</div>
        </div>
        <div class="stat">
          <div class="stat-value" id="rolls">0</div>
          <div class="stat-label">üé≤ Rolls</div>
        </div>
        <div class="stat">
          <div class="stat-value" id="auras-count">0</div>
          <div class="stat-label">‚ú® Auras √∫nicas</div>
        </div>
        <div class="stat">
          <div class="stat-value" id="prestigeLevel">0</div>
          <div class="stat-label">üèÜ Prestigios</div>
        </div>
      </div>
    </div>
    
    <!-- Informaci√≥n de Usuario -->
    <div class="user-info" id="userInfo" style="display:none;">
      <div id="displayUsername"></div>
      <img id="displayAvatar" src="" alt="Avatar" />
    </div>
    
    <!-- Pesta√±as Principales -->
    <div class="tabs">
      <button class="tab active" onclick="switchTab('main', event)">üéÆ Main</button>
      <button class="tab" onclick="switchTab('shop', event)">üõí Shop</button>
      <button class="tab" onclick="switchTab('inventory', event)">üì¶ Inventario</button>
      <button class="tab" onclick="switchTab('prestige', event)">üèÜ Prestigio</button>
      <button class="tab" onclick="switchTab('achievements', event)">üéñÔ∏è Logros</button>
      <button class="tab" onclick="switchTab('leaderboard', event)">üìä Leaderboard</button>
      <button class="tab" onclick="switchTab('codes', event)">üîë C√≥digos</button>
    </div>
    
    <!-- Contenido de cada pesta√±a -->
    
    <!-- Pesta√±a Main -->
    <div id="main-tab" class="tab-content active">
      <div class="main-content">
        <div class="roll-section">
          <div class="roll-animation" id="rollAnimation">
            <div class="aura-name" id="auraName">¬°Haz tu primer roll!</div>
            <div class="aura-rarity" id="auraRarity">Presiona Roll para comenzar</div>
          </div>
          <div class="roll-buttons">
            <!-- Roll gratis: sin costo -->
            <button class="btn btn-roll" onclick="roll()">üé≤ Roll (Gratis)</button>
            <!-- Bot√≥n de Auto Roll (mantiene su funci√≥n, gratis por roll individual) -->
            <button class="btn btn-auto" onclick="toggleAutoRoll()">‚ö° Auto Roll</button>
            <!-- Quick Roll original (10 rolls, pero costar√° 500 monedas) -->
            <button class="btn btn-quick" onclick="quickRoll()">üí® Quick Roll (10 rolls - 500)</button>
            <!-- Botones nuevos para m√°s rolls -->
            <button class="btn btn-quick" onclick="superQuickRoll()">üöÄ Super Quick (20 rolls - 1,000)</button>
            <button class="btn btn-quick" onclick="ultraQuickRoll()">üî• Ultra Quick (50 rolls - 3,000)</button>
          </div>
          <div class="auto-roll-controls" id="autoRollControls" style="display:none;">
            <button class="btn" onclick="stopAutoRoll()">‚èπÔ∏è Detener Auto Roll</button>
            <p>Auto Roll Activo - Velocidad: <span id="autoRollSpeed">1</span> rolls/segundo</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Pesta√±a Shop -->
    <div id="shop-tab" class="tab-content">
      <div class="shop-content">
        <!-- Secci√≥n de Amuletos Permanentes (boosters de suerte) -->
        <div class="shop-section">
          <h2 class="shop-title">üçÄ Amuletos Permanentes</h2>
          <!-- Se incluyen aqu√≠ 10 items (algunos repetidos con variaciones en precio y efecto) -->
          <div class="shop-item">
            <div class="item-info"><h3>Amuleto B√°sico</h3><p>+0.1x Suerte</p></div>
            <div>
              <div class="item-price">1,000</div>
              <button class="btn" onclick="buyLuckUpgrade(0.1, 1000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Tr√©bol Dorado</h3><p>+0.5x Suerte</p></div>
            <div><div class="item-price">5,000</div>
              <button class="btn" onclick="buyLuckUpgrade(0.5, 5000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Piedra de la Fortuna</h3><p>+1.0x Suerte</p></div>
            <div><div class="item-price">10,000</div>
              <button class="btn" onclick="buyLuckUpgrade(1.0, 10000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Amuleto Legendario</h3><p>+2.0x Suerte</p></div>
            <div><div class="item-price">50,000</div>
              <button class="btn" onclick="buyLuckUpgrade(2.0, 50000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Amuleto Quantum</h3><p>+5.0x Suerte</p></div>
            <div><div class="item-price">150,000</div>
              <button class="btn" onclick="buyLuckUpgrade(5.0, 150000)">Comprar</button>
            </div>
          </div>
          <!-- A√±adidos 5 m√°s con variaciones -->
          <div class="shop-item">
            <div class="item-info"><h3>Antorcha de la Suerte</h3><p>+0.2x Suerte</p></div>
            <div><div class="item-price">1,500</div>
              <button class="btn" onclick="buyLuckUpgrade(0.2, 1500)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Medall√≥n Afortunado</h3><p>+0.8x Suerte</p></div>
            <div><div class="item-price">7,000</div>
              <button class="btn" onclick="buyLuckUpgrade(0.8, 7000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Talism√°n de Fuego</h3><p>+1.5x Suerte</p></div>
            <div><div class="item-price">20,000</div>
              <button class="btn" onclick="buyLuckUpgrade(1.5, 20000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Rune Afortunada</h3><p>+0.3x Suerte</p></div>
            <div><div class="item-price">2,500</div>
              <button class="btn" onclick="buyLuckUpgrade(0.3, 2500)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Icono Divino</h3><p>+3.0x Suerte</p></div>
            <div><div class="item-price">100,000</div>
              <button class="btn" onclick="buyLuckUpgrade(3.0, 100000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Emblema Celestial</h3><p>+4.0x Suerte</p></div>
            <div><div class="item-price">200,000</div>
              <button class="btn" onclick="buyLuckUpgrade(4.0, 200000)">Comprar</button>
            </div>
          </div>
        </div>
        
        <!-- Secci√≥n de Pociones Temporales (m√≠nimo 10 items) -->
        <div class="shop-section">
          <h2 class="shop-title">üß™ Pociones Temporales</h2>
          <div class="shop-item">
            <div class="item-info"><h3>Poci√≥n de Suerte</h3><p>+2.0x Suerte por 1 minuto</p></div>
            <div><div class="item-price">500</div>
              <button class="btn" onclick="buyPotion(2,60000,500)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Elixir Divino</h3><p>+5.0x Suerte por 30 segundos</p></div>
            <div><div class="item-price">2,000</div>
              <button class="btn" onclick="buyPotion(5,30000,2000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Bendici√≥n Celestial</h3><p>+7.0x Suerte por 20 segundos</p></div>
            <div><div class="item-price">4,000</div>
              <button class="btn" onclick="buyPotion(7,20000,4000)">Comprar</button>
            </div>
          </div>
          <!-- Otros 7 items -->
          <div class="shop-item">
            <div class="item-info"><h3>Infusi√≥n M√≠stica</h3><p>+3.0x Suerte por 45 segundos</p></div>
            <div><div class="item-price">2,500</div>
              <button class="btn" onclick="buyPotion(3,45000,2500)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Brebaje Arcano</h3><p>+4.0x Suerte por 50 segundos</p></div>
            <div><div class="item-price">3,000</div>
              <button class="btn" onclick="buyPotion(4,50000,3000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Elixir de √âxtasis</h3><p>+6.0x Suerte por 40 segundos</p></div>
            <div><div class="item-price">3,500</div>
              <button class="btn" onclick="buyPotion(6,40000,3500)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>T√≥nico Sobrenatural</h3><p>+8.0x Suerte por 25 segundos</p></div>
            <div><div class="item-price">4,500</div>
              <button class="btn" onclick="buyPotion(8,25000,4500)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Extracto Et√©reo</h3><p>+4.5x Suerte por 55 segundos</p></div>
            <div><div class="item-price">3,800</div>
              <button class="btn" onclick="buyPotion(4.5,55000,3800)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Soluci√≥n M√°gica</h3><p>+3.5x Suerte por 70 segundos</p></div>
            <div><div class="item-price">3,200</div>
              <button class="btn" onclick="buyPotion(3.5,70000,3200)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Concentrado Ancestral</h3><p>+5.5x Suerte por 35 segundos</p></div>
            <div><div class="item-price">2,800</div>
              <button class="btn" onclick="buyPotion(5.5,35000,2800)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Agua Bendita</h3><p>+2.5x Suerte por 80 segundos</p></div>
            <div><div class="item-price">2,200</div>
              <button class="btn" onclick="buyPotion(2.5,80000,2200)">Comprar</button>
            </div>
          </div>
        </div>
        
        <!-- Secci√≥n de Pociones de un solo uso (categor√≠a diferente) -->
        <div class="shop-section">
          <h2 class="shop-title">üî• Pociones de un Solo Uso</h2>
          <!-- Al menos 10 items -->
          <div class="shop-item">
            <div class="item-info"><h3>Poci√≥n OP Instant√°nea</h3><p>+10.0x Suerte por 15 seg</p></div>
            <div><div class="item-price">3,000</div>
              <button class="btn" onclick="buyOneUsePotion(10,15000,3000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Poci√≥n de Fulgor</h3><p>+12.0x Suerte por 10 seg</p></div>
            <div><div class="item-price">6,000</div>
              <button class="btn" onclick="buyOneUsePotion(12,10000,6000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Poci√≥n Rel√°mpago</h3><p>+8.0x Suerte por 20 seg</p></div>
            <div><div class="item-price">4,500</div>
              <button class="btn" onclick="buyOneUsePotion(8,20000,4500)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Poci√≥n Fulminante</h3><p>+15.0x Suerte por 8 seg</p></div>
            <div><div class="item-price">7,500</div>
              <button class="btn" onclick="buyOneUsePotion(15,8000,7500)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Poci√≥n Ef√≠mera</h3><p>+7.5x Suerte por 18 seg</p></div>
            <div><div class="item-price">3,800</div>
              <button class="btn" onclick="buyOneUsePotion(7.5,18000,3800)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Poci√≥n √çgnea</h3><p>+11.0x Suerte por 12 seg</p></div>
            <div><div class="item-price">5,500</div>
              <button class="btn" onclick="buyOneUsePotion(11,12000,5500)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Poci√≥n de Quimeras</h3><p>+9.0x Suerte por 16 seg</p></div>
            <div><div class="item-price">4,200</div>
              <button class="btn" onclick="buyOneUsePotion(9,16000,4200)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Poci√≥n Abrasadora</h3><p>+13.0x Suerte por 14 seg</p></div>
            <div><div class="item-price">6,200</div>
              <button class="btn" onclick="buyOneUsePotion(13,14000,6200)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Poci√≥n Inmediata</h3><p>+10.5x Suerte por 17 seg</p></div>
            <div><div class="item-price">5,000</div>
              <button class="btn" onclick="buyOneUsePotion(10.5,17000,5000)">Comprar</button>
            </div>
          </div>
          <div class="shop-item">
            <div class="item-info"><h3>Poci√≥n Explosiva</h3><p>+14.0x Suerte por 9 seg</p></div>
            <div><div class="item-price">7,000</div>
              <button class="btn" onclick="buyOneUsePotion(14,9000,7000)">Comprar</button>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Pesta√±a Inventario -->
    <div id="inventory-tab" class="tab-content">
      <div class="shop-section">
        <h2 class="shop-title">üì¶ Inventario de Auras</h2>
        <div class="inventory-grid" id="inventoryGrid">
          <p style="text-align:center; opacity:0.7; grid-column:1/-1;">
            Tu inventario est√° vac√≠o. ¬°Haz algunos rolls para conseguir auras!
          </p>
        </div>
      </div>
    </div>
    
    <!-- Pesta√±a Prestigio -->
    <div id="prestige-tab" class="tab-content">
      <h2>Prestigio</h2>
      <p>Prestigio acumulado: <span id="prestigeDisplay">0</span></p>
      <p>Requiere al menos 10,000 monedas para prestigiar.</p>
      <button class="btn" onclick="prestigeGame()">Prestigiar (Reinicia tu progreso a cambio de bono de suerte)</button>
    </div>
    
    <!-- Pesta√±a Logros -->
    <div id="achievements-tab" class="tab-content">
      <h2>üéñÔ∏è Logros</h2>
      <div id="achievementsList" style="display:flex; flex-wrap:wrap; gap:20px; justify-content:center;"></div>
    </div>
    
    <!-- Pesta√±a Leaderboard -->
    <div id="leaderboard-tab" class="tab-content">
      <h2>üìä Leaderboard</h2>
      <div class="leaderboard-tabs">
        <button class="lboard-tab active" data-type="rare" onclick="switchLeaderboard('rare', event)">M√°s Raro</button>
        <button class="lboard-tab" data-type="prestige" onclick="switchLeaderboard('prestige', event)">M√°s Prestigios</button>
        <button class="lboard-tab" data-type="rolls" onclick="switchLeaderboard('rolls', event)">M√°s Rolls</button>
      </div>
      <div id="leaderboardContent"></div>
    </div>
    
    <!-- Pesta√±a C√≥digos -->
    <div id="codes-tab" class="tab-content">
      <h2>üîë Canjear C√≥digo</h2>
      <input type="text" id="codeInput" placeholder="Ingresa tu c√≥digo" />
      <button class="btn" onclick="redeemCode()">Canjear</button>
      <div id="codeMessage"></div>
    </div>
    
    <!-- Admin Panel (solo para Kai (owner)) -->
    <div id="adminPanel" style="display:none;">
      <h2>Admin Panel</h2>
      <div>
        <input type="number" id="adminAddCoins" placeholder="Cantidad de monedas" />
        <button onclick="adminAddCoins()">Add Coins</button>
      </div>
      <div>
        <input type="text" id="adminResetUser" placeholder="Nombre del usuario" />
        <button onclick="adminResetUserData()">Reset Player Data</button>
      </div>
      <div>
        <button onclick="adminResetAllData()">Reset All Data</button>
      </div>
    </div>
    
  </div>
  
  <!-- Overlay para animaciones -->
  <div class="animation-overlay" id="animationOverlay" style="display:none;">
    <div class="particles" id="particles"></div>
  </div>
  
  <script>
    ////////////////////////////
    // Estado inicial del juego
    ////////////////////////////
    let gameState = {
      coins: 1000,
      luck: 1.0,
      totalRolls: 0,
      auras: [],
      autoRollActive: false,
      autoRollInterval: null,
      prestige: 0,
      username: null,
      avatar: null,
      bestAura: 0,
      oneUsePotions: 0,
      codesRedeemed: [],
      achievementsClaimed: {}
    };

    // Datos de logros de ejemplo
    const achievementData = [
      { id: "roll1", name: "Primer Roll", condition: () => gameState.totalRolls >= 1, reward: "Bonus: +0.05 suerte" },
      { id: "roll10", name: "10 Rolls Realizados", condition: () => gameState.totalRolls >= 10, reward: "Bonus: +0.1 suerte" },
      { id: "legendAura", name: "Aura Legendaria", condition: () => gameState.bestAura >= 100000, reward: "Bonus: +0.2 suerte" },
      { id: "collection50", name: "Coleccionista: 50 auras √∫nicas", condition: () => {
          const unique = {};
          gameState.auras.forEach(aura => { unique[aura.name + "-" + aura.rarity] = true; });
          return Object.keys(unique).length >= 50;
        }, reward: "Bonus: +0.3 suerte" }
    ];

    ////////////////////////////
    // Sonidos y Animaciones
    ////////////////////////////
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(frequency, duration, type = 'sine') {
      const oscillator = audioContext.createOscillator();
      const gainNode = audioContext.createGain();
      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      oscillator.frequency.value = frequency;
      oscillator.type = type;
      gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
      gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
      oscillator.start(audioContext.currentTime);
      oscillator.stop(audioContext.currentTime + duration);
    }

    ////////////////////////////
    // Guardado y Carga (localStorage)
    ////////////////////////////
    function saveGame() {
      localStorage.setItem("auraGameSave", JSON.stringify(gameState));
      updateGlobalLeaderboard();
    }
    function loadGame() {
      const saveData = localStorage.getItem("auraGameSave");
      if(saveData) {
        try {
          const loaded = JSON.parse(saveData);
          gameState = { ...gameState, ...loaded };
          updateUI();
          updateInventory();
          updateAchievements();
          updateGlobalLeaderboard();
          if(gameState.username) {
            document.getElementById("loginModal").style.display = "none";
            document.getElementById("userInfo").style.display = "block";
            document.getElementById("displayUsername").textContent = gameState.username;
            if(gameState.avatar) {
              document.getElementById("displayAvatar").src = gameState.avatar;
            }
          }
        } catch(e) { console.error("Error al cargar el save."); }
      }
      // Si el usuario es "Kai (owner)", se muestra el Admin Panel
      if(gameState.username === "Kai (owner)") {
        document.getElementById("adminPanel").style.display = "block";
      }
    }
    setInterval(saveGame, 30000);

    ////////////////////////////
    // Registro y Login con verificaci√≥n
    ////////////////////////////
    function loginUser() {
      const username = document.getElementById("usernameInput").value.trim();
      const errorDiv = document.getElementById("loginError");
      if(!username) { errorDiv.textContent = "Ingresa un nombre de usuario."; return; }
      
      // Verificar si el nombre ya existe (almacenando en "kaiRngRegisteredUsers")
      let registered = JSON.parse(localStorage.getItem("kaiRngRegisteredUsers") || "[]");
      if(registered.includes(username)) {
        errorDiv.textContent = "El nombre ya est√° en uso. Elige otro.";
        return;
      }
      // Agregar el nombre a la lista de registrados
      registered.push(username);
      localStorage.setItem("kaiRngRegisteredUsers", JSON.stringify(registered));
      
      gameState.username = username;
      const avatarFile = document.getElementById("avatarInput").files[0];
      if(avatarFile) {
        const reader = new FileReader();
        reader.onload = (e) => {
          gameState.avatar = e.target.result;
          document.getElementById("displayAvatar").src = gameState.avatar;
          finalizeLogin();
        };
        reader.readAsDataURL(avatarFile);
      } else {
        finalizeLogin();
      }
    }
    function finalizeLogin() {
      document.getElementById("loginModal").style.display = "none";
      document.getElementById("userInfo").style.display = "block";
      document.getElementById("displayUsername").textContent = gameState.username;
      saveGame();
    }

    ////////////////////////////
    // Actualizar UI (estad√≠sticas)
    ////////////////////////////
    function updateUI() {
      document.getElementById("coins").textContent = gameState.coins.toLocaleString();
      document.getElementById("luck").textContent = getTotalLuck().toFixed(1) + "x";
      document.getElementById("rolls").textContent = gameState.totalRolls.toLocaleString();
      const unique = {};
      gameState.auras.forEach(aura => { unique[aura.name + "-" + aura.rarity] = true; });
      document.getElementById("auras-count").textContent = Object.keys(unique).length;
      document.getElementById("prestigeLevel").textContent = gameState.prestige;
    }
    function getTotalLuck() { return gameState.luck; }

    ////////////////////////////
    // Definici√≥n de Auras y Sistema RNG
    ////////////////////////////
    let auras = [
      // Common
      {name: "Brisa Com√∫n", rarity: "Common", minValue: 1, maxValue: 100, color: "#95a5a6", chance: 40},
      {name: "Luz B√°sica", rarity: "Common", minValue: 1, maxValue: 100, color: "#95a5a6", chance: 35},
      // Rare  
      {name: "Viento Azul", rarity: "Rare", minValue: 101, maxValue: 1000, color: "#3498db", chance: 15},
      {name: "Chispa El√©ctrica", rarity: "Rare", minValue: 101, maxValue: 1000, color: "#3498db", chance: 12},
      // Epic
      {name: "Llama P√∫rpura", rarity: "Epic", minValue: 1001, maxValue: 10000, color: "#9b59b6", chance: 8},
      {name: "Cristal M√≠stico", rarity: "Epic", minValue: 1001, maxValue: 10000, color: "#9b59b6", chance: 6},
      // Legendary
      {name: "Oro Radiante", rarity: "Legendary", minValue: 10001, maxValue: 100000, color: "#f39c12", chance: 3},
      {name: "F√©nix Dorado", rarity: "Legendary", minValue: 10001, maxValue: 100000, color: "#f39c12", chance: 2},
      // Mythic
      {name: "Drag√≥n Carmes√≠", rarity: "Mythic", minValue: 100001, maxValue: 1000000, color: "#e74c3c", chance: 1},
      {name: "Tormenta Eterna", rarity: "Mythic", minValue: 100001, maxValue: 1000000, color: "#e74c3c", chance: 0.8},
      // Divine
      {name: "Aurora Divina", rarity: "Divine", minValue: 1000001, maxValue: 100000000, color: "#fd79a8", chance: 0.5},
      {name: "Estrella Celestial", rarity: "Divine", minValue: 1000001, maxValue: 100000000, color: "#fd79a8", chance: 0.3},
      // Celestial
      {name: "Galaxia Infinita", rarity: "Celestial", minValue: 100000001, maxValue: 1000000000, color: "#00cec9", chance: 0.1},
      {name: "Cosmos Eterno", rarity: "Celestial", minValue: 100000001, maxValue: 1000000000, color: "#00cec9", chance: 0.08},
      // Transcendent
      {name: "Omnipresencia", rarity: "Transcendent", minValue: 1000000001, maxValue: 10000000000, color: "#6c5ce7", chance: 0.05},
      {name: "Realidad Absoluta", rarity: "Transcendent", minValue: 1000000001, maxValue: 10000000000, color: "#6c5ce7", chance: 0.03},
      // Omnipotent
      {name: "DIOS SUPREMO", rarity: "Omnipotent", minValue: 10000000001, maxValue: 100000000000, color: "#ffd700", chance: 0.01},
      {name: "CREADOR UNIVERSAL", rarity: "Omnipotent", minValue: 10000000001, maxValue: 100000000000, color: "#ffd700", chance: 0.005},
      // Nuevas rarezas: Ethereal y Fabled y Ascended, Infinite y Quantum
      {name: "Esencia Et√©rea", rarity: "Ethereal", minValue: 100000000001, maxValue: 1000000000000, color: "#a29bfe", chance: 0.002},
      {name: "Luz Et√©rea", rarity: "Ethereal", minValue: 100000000001, maxValue: 1000000000000, color: "#a29bfe", chance: 0.0015},
      {name: "Susurro Fabuloso", rarity: "Fabled", minValue: 1000000000001, maxValue: 10000000000000, color: "#fd79a8", chance: 0.001},
      {name: "Leyenda Fabulosa", rarity: "Fabled", minValue: 1000000000001, maxValue: 10000000000000, color: "#fd79a8", chance: 0.0008},
      {name: "Alba Ascendida", rarity: "Ascended", minValue: 10000000000001, maxValue: 100000000000000, color: "#55efc4", chance: 0.0005},
      {name: "Crep√∫sculo Ascendido", rarity: "Ascended", minValue: 10000000000001, maxValue: 100000000000000, color: "#55efc4", chance: 0.0004},
      {name: "Infinito", rarity: "Infinite", minValue: 100000000000001, maxValue: 1000000000000000, color: "#ffeaa7", chance: 0.0002},
      {name: "Eternidad", rarity: "Infinite", minValue: 100000000000001, maxValue: 1000000000000000, color: "#ffeaa7", chance: 0.0001},
      {name: "Part√≠cula Quantum", rarity: "Quantum", minValue: 1000000000000001, maxValue: 10000000000000000, color: "#ff9ff3", chance: 0.00005},
      {name: "Singularidad Quantum", rarity: "Quantum", minValue: 1000000000000001, maxValue: 10000000000000000, color: "#ff9ff3", chance: 0.00003}
    ];

    // En el roll gratis ya no se resta monedas
    function roll() {
      gameState.totalRolls++;
      playSound(400, 0.2);
      document.getElementById("rollAnimation").classList.add("rolling");
      setTimeout(() => {
        const result = performRoll();
        displayRollResult(result);
        document.getElementById("rollAnimation").classList.remove("rolling");
        updateUI();
        updateAchievements();
      }, 1000);
    }
    
    // La recompensa en monedas se reduce (valor/100 en vez de /10)
    function performRoll() {
      const weightedAuras = auras.map(aura => ({ ...aura, adjustedChance: aura.chance * getTotalLuck() }));
      const totalWeight = weightedAuras.reduce((sum, aura) => sum + aura.adjustedChance, 0);
      let random = Math.random() * totalWeight;
      for(const aura of weightedAuras) {
        random -= aura.adjustedChance;
        if(random <= 0) {
          const value = Math.floor(Math.random() * (aura.maxValue - aura.minValue + 1)) + aura.minValue;
          const newAura = { ...aura, value, id: Date.now() + Math.random() };
          gameState.auras.push(newAura);
          gameState.coins += Math.floor(value / 100);
          if(value > gameState.bestAura) { gameState.bestAura = value; }
          return newAura;
        }
      }
      const fallback = weightedAuras[0];
      const value = Math.floor(Math.random() * (fallback.maxValue - fallback.minValue + 1)) + fallback.minValue;
      const newAura = { ...fallback, value, id: Date.now() + Math.random() };
      gameState.auras.push(newAura);
      gameState.coins += Math.floor(value / 100);
      return newAura;
    }
    
    function displayRollResult(aura) {
      const auraName = document.getElementById("auraName");
      const auraRarity = document.getElementById("auraRarity");
      auraName.textContent = aura.name;
      auraName.style.color = aura.color;
      auraRarity.textContent = `${aura.rarity} - Valor: ${aura.value.toLocaleString()}`;
      auraRarity.style.backgroundColor = aura.color + "20";
      auraRarity.style.borderColor = aura.color;
      if(aura.value >= 1000000000) { triggerSpecialAnimation(aura); playSound(800,2,"sawtooth"); }
      else if(aura.value >= 100000000) { triggerUltraAnimation(aura); playSound(700,1.5,"square"); }
      else if(aura.value >= 1000000) { triggerMegaAnimation(aura); playSound(600,1,"triangle"); }
      else if(aura.value >= 100000) { triggerAnimation(aura); playSound(500,0.8); }
      else if(aura.value >= 10000) { triggerBasicAnimation(aura); playSound(450,0.5); }
      updateInventory();
      updateGlobalLeaderboard();
    }
    
    // Animaciones de part√≠culas y efectos especiales
    function triggerBasicAnimation(aura) { createParticles(20, aura.color); }
    function triggerAnimation(aura) {
      createParticles(50, aura.color);
      const overlay = document.getElementById("animationOverlay");
      overlay.style.display = "block";
      overlay.style.background = `radial-gradient(circle, ${aura.color}20, transparent 70%)`;
      setTimeout(() => { overlay.style.display = "none"; }, 2000);
    }
    function triggerMegaAnimation(aura) {
      createParticles(100, aura.color);
      const overlay = document.getElementById("animationOverlay");
      overlay.innerHTML = `
        <div class="particles" id="particles"></div>
        <div class="mega-animation" style="color: ${aura.color}; text-shadow: 0 0 50px ${aura.color};">
          ‚ú® ${aura.name.toUpperCase()} ‚ú®
          <div style="font-size: 2rem; margin-top: 20px;">MEGA RARE!</div>
        </div>`;
      overlay.style.display = "block";
      overlay.style.background = `radial-gradient(circle, ${aura.color}30, transparent 70%)`;
      setTimeout(() => { overlay.style.display = "none"; }, 3000);
      createParticles(100, aura.color);
    }
    function triggerUltraAnimation(aura) {
      createParticles(200, aura.color);
      const overlay = document.getElementById("animationOverlay");
      overlay.innerHTML = `
        <div class="particles" id="particles"></div>
        <div class="mega-animation ultra-animation" style="color: ${aura.color}; text-shadow: 0 0 80px ${aura.color};">
          üåü ${aura.name.toUpperCase()} üåü
          <div style="font-size: 2.5rem; margin-top: 20px;">ULTRA LEGENDARY!</div>
          <div style="font-size: 1.5rem; margin-top: 10px;">Valor: ${aura.value.toLocaleString()}</div>
        </div>`;
      overlay.classList.add("ultra-animation");
      overlay.style.display = "block";
      setTimeout(() => { overlay.style.display = "none"; overlay.classList.remove("ultra-animation"); }, 3000);
      document.body.style.animation = "shake 0.5s ease-in-out";
      setTimeout(() => { document.body.style.animation = ""; }, 500);
    }
    function triggerSpecialAnimation(aura) {
      createParticles(500, aura.color);
      const overlay = document.getElementById("animationOverlay");
      overlay.innerHTML = `
        <div class="particles" id="particles"></div>
        <div class="mega-animation special-animation" style="color: #fff; text-shadow: 0 0 100px ${aura.color}, 0 0 200px #fff;">
          ‚≠ê ${aura.name.toUpperCase()} ‚≠ê
          <div style="font-size: 3rem; margin-top: 20px;">GODLIKE!</div>
          <div style="font-size: 2rem; margin-top: 15px;">Valor: ${aura.value.toLocaleString()}</div>
          <div style="font-size: 1.2rem; margin-top: 10px;">¬°IMPOSIBLE!</div>
        </div>`;
      overlay.classList.add("special-animation");
      overlay.style.display = "block";
      setTimeout(() => { overlay.style.display = "none"; overlay.classList.remove("special-animation"); }, 4000);
      document.body.style.animation = "shake 2s ease-in-out";
      setTimeout(() => { document.body.style.animation = ""; }, 2000);
    }
    function createParticles(count, color) {
      const particles = document.getElementById("particles");
      for(let i = 0; i < count; i++) {
        const particle = document.createElement("div");
        particle.className = "particle";
        particle.style.left = Math.random() * 100 + "%";
        particle.style.backgroundColor = color || "#ffd700";
        particle.style.animationDelay = Math.random() * 2 + "s";
        particle.style.animationDuration = (Math.random() * 3 + 2) + "s";
        particles.appendChild(particle);
        setTimeout(() => { if(particle.parentNode) particle.parentNode.removeChild(particle); }, 5000);
      }
    }
    
    // Quick Roll: 10 rolls (cost 500 monedas)
    function quickRoll() {
      if(gameState.coins < 500) { playSound(200,0.3); alert("¬°No tienes suficientes monedas para Quick Roll!"); return; }
      gameState.coins -= 500;
      gameState.totalRolls += 10;
      playSound(600,0.3,"square");
      document.getElementById("rollAnimation").classList.add("rolling");
      let results = [];
      for(let i = 0; i < 10; i++) { results.push(performRoll()); }
      setTimeout(() => {
        let bestResult = results.reduce((a,b) => a.value > b.value ? a : b);
        displayRollResult(bestResult);
        document.getElementById("rollAnimation").classList.remove("rolling");
        updateUI();
        alert(`Quick Roll completado: Mejor aura: ${bestResult.name} (${bestResult.value.toLocaleString()})`);
      }, 1500);
    }
    
    // Super Quick Roll: 20 rolls (cost 1,000 monedas)
    function superQuickRoll() {
      if(gameState.coins < 1000) { playSound(200,0.3); alert("¬°No tienes suficientes monedas para Super Quick Roll!"); return; }
      gameState.coins -= 1000;
      gameState.totalRolls += 20;
      playSound(650,0.3,"square");
      document.getElementById("rollAnimation").classList.add("rolling");
      let results = [];
      for(let i = 0; i < 20; i++) { results.push(performRoll()); }
      setTimeout(() => {
        let bestResult = results.reduce((a,b) => a.value > b.value ? a : b);
        displayRollResult(bestResult);
        document.getElementById("rollAnimation").classList.remove("rolling");
        updateUI();
        alert(`Super Quick Roll: Mejor aura: ${bestResult.name} (${bestResult.value.toLocaleString()})`);
      }, 1500);
    }

    // Ultra Quick Roll: 50 rolls (cost 3,000 monedas)
    function ultraQuickRoll() {
      if(gameState.coins < 3000) { playSound(200,0.3); alert("¬°No tienes suficientes monedas para Ultra Quick Roll!"); return; }
      gameState.coins -= 3000;
      gameState.totalRolls += 50;
      playSound(700,0.3,"square");
      document.getElementById("rollAnimation").classList.add("rolling");
      let results = [];
      for(let i = 0; i < 50; i++) { results.push(performRoll()); }
      setTimeout(() => {
        let bestResult = results.reduce((a,b) => a.value > b.value ? a : b);
        displayRollResult(bestResult);
        document.getElementById("rollAnimation").classList.remove("rolling");
        updateUI();
        alert(`Ultra Quick Roll: Mejor aura: ${bestResult.name} (${bestResult.value.toLocaleString()})`);
      }, 1500);
    }
    
    // Auto Roll
    function toggleAutoRoll() {
      if(gameState.autoRollActive) { stopAutoRoll(); }
      else { startAutoRoll(); }
    }
    function startAutoRoll() {
      if(gameState.coins < 50) { playSound(200,0.3); alert("¬°No tienes suficientes monedas para Auto Roll!"); return; }
      gameState.autoRollActive = true;
      document.getElementById("autoRollControls").style.display = "block";
      playSound(500,0.2);
      gameState.autoRollInterval = setInterval(() => {
        if(gameState.coins >= 50) { roll(); }
        else { stopAutoRoll(); alert("¬°Auto Roll detenido!"); }
      }, 1000);
    }
    function stopAutoRoll() {
      gameState.autoRollActive = false;
      document.getElementById("autoRollControls").style.display = "none";
      if(gameState.autoRollInterval) { clearInterval(gameState.autoRollInterval); gameState.autoRollInterval = null; }
      playSound(300,0.3);
    }
    
    // Tienda: Boosters y Pociones ya implementadas en los botones de cada item.
    // Las funciones buyLuckUpgrade, buyPotion y buyOneUsePotion se usan en Shop.
    function buyLuckUpgrade(increase, cost) {
      if(gameState.coins >= cost) {
        gameState.coins -= cost;
        gameState.luck += increase;
        playSound(600,0.5,"triangle");
        updateUI();
        alert(`¬°Amuleto comprado! +${increase}x suerte permanente.`);
      } else { playSound(200,0.3); alert("¬°No tienes suficientes monedas!"); }
    }
    function buyPotion(multiplier, duration, cost) {
      if(gameState.coins >= cost) {
        gameState.coins -= cost;
        gameState.potionActive = true;
        gameState.potionMultiplier = multiplier;
        gameState.potionEndTime = Date.now() + duration;
        playSound(700,0.8,"sine");
        updateUI();
        alert(`¬°Poci√≥n activada! +${multiplier}x suerte por ${duration/1000} segundos.`);
        const potionInterval = setInterval(() => {
          if(Date.now() >= gameState.potionEndTime) {
            clearInterval(potionInterval);
            gameState.potionActive = false;
            gameState.potionMultiplier = 0;
            updateUI();
            alert("¬°Efecto de poci√≥n terminado!");
          } else { updateUI(); }
        }, 1000);
      } else { playSound(200,0.3); alert("¬°No tienes suficientes monedas!"); }
    }
    function buyOneUsePotion(multiplier, duration, cost) {
      if(gameState.coins >= cost) {
        gameState.coins -= cost;
        gameState.oneUsePotions = (gameState.oneUsePotions || 0) + 1;
        playSound(750,0.6,"triangle");
        updateUI();
        alert(`¬°Poci√≥n de un solo uso comprada! √ösala para +${multiplier}x suerte por ${duration/1000} segundos.`);
      } else { playSound(200,0.3); alert("¬°No tienes suficientes monedas!"); }
    }
    
    // Prestigio: requiere 10,000 monedas
    function prestigeGame() {
      if(gameState.coins < 10000) { alert("Necesitas al menos 10,000 monedas para prestigiar."); return; }
      if(confirm("Prestigiar reiniciar√° tu progreso (excepto tu cuenta) a cambio de un bono permanente en suerte. ¬øContinuar?")) {
        gameState.prestige++;
        gameState.luck += 0.2;
